
CREATE PROCEDURE [dbo].[uspWSOL_SSRS_SATS_SCANNER_AGENT_STATUSES]
 @DATE_BEG           DATETIME
,@DATE_END           DATETIME
AS
SET NOCOUNT ON

--  EXECUTE [dbo].[uspWSOL_SSRS_SATS_SCANNER_AGENT_STATUSES] '06/19/2017','06/19/2017'

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
DECLARE
 @DTM_BEG AS DATETIME
,@DTM_END AS DATETIME
SET @DTM_BEG = CAST(CONVERT(VARCHAR(10),@DATE_BEG,101) AS DATETIME) 
SET @DTM_END = CAST(CONVERT(VARCHAR(10),@DATE_END,101) AS DATETIME) + 1
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
 AGT.STATUS_ID
,AGT.STATUS_NAME
FROM 
(	SELECT
	 APP.IDAPPSTATUS				AS STATUS_ID
	,CASE WHEN STA.IDAPPSTATUS = 0
		  THEN 'NO STATUS'
		  ELSE STA.[NAME]
	 END							AS STATUS_NAME
	--  SELECT *
	FROM
	 APPLICANT	APP
	,APPSTATUS	STA	
		
	WHERE APP.IDAPPSTATUS = STA.IDAPPSTATUS
	  AND STA.VISIBLE = 'Y'
	--WHERE YT.[DATETIME] >= @DTM_BEG AND YT.[DATETIME] <  @DTM_END

	GROUP BY
	 APP.IDAPPSTATUS
	,CASE WHEN STA.IDAPPSTATUS = 0
		  THEN 'NO STATUS'
		  ELSE STA.[NAME]
	 END
) AGT
ORDER BY AGT.STATUS_NAME

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

GO