
CREATE PROCEDURE [dbo].[uspWSOL_SSRS_AUTO_INVOICE_UNACCEPTED_INVOICES_CLIENTS]
 @DATE_BEG           DATETIME
,@DATE_END           DATETIME
AS
SET NOCOUNT ON

--  EXECUTE [dbo].[uspWSOL_SSRS_AUTO_INVOICE_CLIENTS] '06/19/2017','06/19/2017'

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
DECLARE
 @DTM_BEG AS DATETIME
,@DTM_END AS DATETIME
SET @DTM_BEG = CAST(CONVERT(VARCHAR(10),@DATE_BEG,101) AS DATETIME) 
SET @DTM_END = CAST(CONVERT(VARCHAR(10),@DATE_END,101) AS DATETIME) + 1
--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SELECT
 INV.CLIENT_ID
,INV.CLIENT_NAME
FROM 
(	SELECT
	 ISNULL(P.IDCLIENT,9999)				AS CLIENT_ID
	,ISNULL(C.[NAME],'00-NO CLIENT NAME')	AS CLIENT_NAME
	--  SELECT *
	FROM		AUTOINVTOTAL	I
	LEFT JOIN	PROJECT			P ON I.IDPROJECT = P.IDPROJECT
	LEFT JOIN	CLIENT			C ON P.IDCLIENT  = C.ID

	WHERE I.RECSTATUS = 'N'
	--WHERE YT.[DATETIME] >= @DTM_BEG AND YT.[DATETIME] <  @DTM_END

	GROUP BY
	 P.IDCLIENT
	,C.[NAME]
) INV
ORDER BY INV.CLIENT_NAME

--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

GO