
CREATE   VIEW [dbo].[WSOL_VW_SCHEDULE_DETAIL]
AS

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID				AS CLIENT_ID
,C.[NAME]			AS CLIENT_NAME
,P.[NAME]			AS [PROGRAM_NAME]
,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0000) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR
,C.ID
,C.[NAME]
,P.[NAME]

UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID				AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0015) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0030) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0045) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0100) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0115) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0130) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0145) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0200) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0215) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0230) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0245) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0300) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0315) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0330) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0345) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0400) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0415) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0430) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0445) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0500) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0515) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0530) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0545) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0600) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID
WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID
,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0615) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID
WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0630) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0645) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0700) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0715) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0730) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0745) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0800) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0815) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0830) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0845) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0900) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0915) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0930) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F0945) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1000) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1015) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1030) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1045) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1100) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1115) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1130) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1145) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1200) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1215) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1230) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1245) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1300) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1315) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1330) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1345) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1400) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1415) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1430) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1445) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1500) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1515) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1530) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1545) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1600) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1615) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1630) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1645) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1700) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1715) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1730) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1745) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1800) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1815) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1830) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1845) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1900) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1915) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1930) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F1945) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2000) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2015) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2030) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2045) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2100) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2115) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2130) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2145) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2200) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2215) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2230) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2245) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:00:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2300) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID AS CLIENT_ID,C.[NAME] AS CLIENT_NAME,P.[NAME] AS [PROGRAM_NAME] ,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:15:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2315) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT C ON P.IDCLIENT = C.ID WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR

,C.ID,C.[NAME] ,P.[NAME] UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID				AS CLIENT_ID
,C.[NAME]			AS CLIENT_NAME
,P.[NAME]			AS [PROGRAM_NAME]
,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:30:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2330) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR
,C.ID
,C.[NAME]
,P.[NAME]

UNION ALL

SELECT
 S.IDAGENT
,S.DATESCH			AS SCHEDULE_DATE
,S.IDPROGR
,C.ID				AS CLIENT_ID
,C.[NAME]			AS CLIENT_NAME
,P.[NAME]			AS [PROGRAM_NAME]
,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:45:00' AS DATETIME)	AS INTERVAL_START
,CASE WHEN SUM(S.F2345) > 0 THEN 900 ELSE 0 END						AS SCHEDULED_SECS
FROM  SCHTIMES_AGENT	S
LEFT JOIN PROGRAM		P ON S.IDPROGR = P.ID
LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
WHERE P.ISSHOW = 1
GROUP BY
 S.IDAGENT
,S.DATESCH
,S.IDPROGR
,C.ID
,C.[NAME]
,P.[NAME]

GO