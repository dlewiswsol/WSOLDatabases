
-- =======================================================================
-- Author:		ISAAC GUARDIOLA
-- Create date:	2017-08-29
-- Description:	FUNCTION TO RETURN SCHEDULE TYPE DATA BY INTERVAL
-- =======================================================================
CREATE FUNCTION [dbo].[TVF_WSOL_SCHEDULE_TYPE_DATA_BY_INTERVALS] 
(
	-- Add the parameters for the function here
	 @DTM_BEG		DATETIME
	,@DTM_END		DATETIME
	,@INTERVAL		VARCHAR(1) 
	,@DUR_IN		VARCHAR(1)
	,@CLIENT_ID		VARCHAR(3500)
	,@PROGRAM_ID	VARCHAR(3500)
)
RETURNS 
@RESULTS_TABLE TABLE 
(
	-- Add the column definitions for the TABLE variable here
	 SCHEDULE_DATE				DATETIME
	,INTERVAL_START				CHAR(5)
	,SCHEDULE_DATE_INT			DATETIME
	,CLIENT_ID					VARCHAR(50)
	,CLIENT_NAME				VARCHAR(200)
	,PROGRAM_ID					VARCHAR(50)
	,[PROGRAM_NAME]				VARCHAR(200)
	,SCHEDULED_TIME_ORIGINAL	DECIMAL(10,2)
	,SCHEDULED_TIME_ADDITIONAL	DECIMAL(10,2)
	,REDUCED_TIME_CLIENT		DECIMAL(10,2)
	,REDUCED_TIME_WSOL			DECIMAL(10,2)
)
AS
BEGIN
	-- Fill the table variable with the rows for your result set

	SET @CLIENT_ID	= ',' + LTRIM(RTRIM(REPLACE(@CLIENT_ID	,'ALL','0'))) + ','
	SET @PROGRAM_ID	= ',' + LTRIM(RTRIM(REPLACE(@PROGRAM_ID	,'ALL','0'))) + ','

	--==================================
	--	SET AMOUNT TO DIVIDE BY:
	--==================================
	DECLARE @DS DECIMAL(10,2)
	IF @DUR_IN = 'S' BEGIN
		SET @DS = 1.00
	END
	IF @DUR_IN = 'M' BEGIN
		SET @DS = 60.00
	END
	IF @DUR_IN = 'H' BEGIN
		SET @DS = 3600.00
	END
	;
	WITH SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS
	(
	 DATESCH
	,IDPROGR
	,LIMITHR
	,F0000,F0015,F0030,F0045
	,F0100,F0115,F0130,F0145
	,F0200,F0215,F0230,F0245
	,F0300,F0315,F0330,F0345
	,F0400,F0415,F0430,F0445
	,F0500,F0515,F0530,F0545
	,F0600,F0615,F0630,F0645
	,F0700,F0715,F0730,F0745
	,F0800,F0815,F0830,F0845
	,F0900,F0915,F0930,F0945
	,F1000,F1015,F1030,F1045
	,F1100,F1115,F1130,F1145
	,F1200,F1215,F1230,F1245
	,F1300,F1315,F1330,F1345
	,F1400,F1415,F1430,F1445
	,F1500,F1515,F1530,F1545
	,F1600,F1615,F1630,F1645
	,F1700,F1715,F1730,F1745
	,F1800,F1815,F1830,F1845
	,F1900,F1915,F1930,F1945
	,F2000,F2015,F2030,F2045
	,F2100,F2115,F2130,F2145
	,F2200,F2215,F2230,F2245
	,F2300,F2315,F2330,F2345
	,DATEINS
	,DATEUPD
	,LIMITHOURSUNTIL
	,TYPEOFSCHEDULE
	) AS
	(
	SELECT
	 DATESCH
	,IDPROGR
	,LIMITHR
	,F0000,F0015,F0030,F0045
	,F0100,F0115,F0130,F0145
	,F0200,F0215,F0230,F0245
	,F0300,F0315,F0330,F0345
	,F0400,F0415,F0430,F0445
	,F0500,F0515,F0530,F0545
	,F0600,F0615,F0630,F0645
	,F0700,F0715,F0730,F0745	
	,F0800,F0815,F0830,F0845
	,F0900,F0915,F0930,F0945
	,F1000,F1015,F1030,F1045
	,F1100,F1115,F1130,F1145
	,F1200,F1215,F1230,F1245
	,F1300,F1315,F1330,F1345
	,F1400,F1415,F1430,F1445
	,F1500,F1515,F1530,F1545
	,F1600,F1615,F1630,F1645
	,F1700,F1715,F1730,F1745
	,F1800,F1815,F1830,F1845
	,F1900,F1915,F1930,F1945
	,F2000,F2015,F2030,F2045
	,F2100,F2115,F2130,F2145
	,F2200,F2215,F2230,F2245
	,F2300,F2315,F2330,F2345
	,MAX(DATEINS)			AS DATEINS
	,MAX(DATEUPD)			AS DATEUPD
	,MAX(LIMITHOURSUNTIL)	AS LIMITHOURSUNTIL
	,TYPEOFSCHEDULE
	FROM SCHTIMES_TL_SCHEDULE_TYPE
	WHERE ( CAST(DATESCH AS DATETIME) >= @DTM_BEG AND CAST(DATESCH AS DATETIME) < @DTM_END )
	  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(IDPROGR) + ',',@PROGRAM_ID) > 0   )
	GROUP BY
	 DATESCH
	,IDPROGR
	,LIMITHR
	,F0000,F0015,F0030,F0045
	,F0100,F0115,F0130,F0145
	,F0200,F0215,F0230,F0245
	,F0300,F0315,F0330,F0345
	,F0400,F0415,F0430,F0445
	,F0500,F0515,F0530,F0545
	,F0600,F0615,F0630,F0645
	,F0700,F0715,F0730,F0745
	,F0800,F0815,F0830,F0845
	,F0900,F0915,F0930,F0945
	,F1000,F1015,F1030,F1045
	,F1100,F1115,F1130,F1145
	,F1200,F1215,F1230,F1245
	,F1300,F1315,F1330,F1345
	,F1400,F1415,F1430,F1445
	,F1500,F1515,F1530,F1545
	,F1600,F1615,F1630,F1645
	,F1700,F1715,F1730,F1745
	,F1800,F1815,F1830,F1845
	,F1900,F1915,F1930,F1945
	,F2000,F2015,F2030,F2045
	,F2100,F2115,F2130,F2145
	,F2200,F2215,F2230,F2245
	,F2300,F2315,F2330,F2345
	,TYPEOFSCHEDULE
	)

	INSERT INTO @RESULTS_TABLE
	SELECT
	 DAT.SCHEDULE_DATE
	,DAT.INTERVAL_START
	,CAST(CONVERT(VARCHAR(10),CONVERT(DATE,DAT.SCHEDULE_DATE)) + ' ' + DAT.INTERVAL_START + ':00' AS DATETIME)	AS SCHEDULE_DATE_INT
	,DAT.CLIENT_ID
	,DAT.CLIENT_NAME
	,DAT.PROGRAM_ID
	,DAT.[PROGRAM_NAME]
	,DAT.SCHEDULED_TIME_ORIGINAL
	,DAT.SCHEDULED_TIME_ADDITIONAL
	,DAT.REDUCED_TIME_CLIENT
	,DAT.REDUCED_TIME_WSOL
	FROM
	(	SELECT	
		 CAST(SCH.SCHEDULE_DATE AS DATETIME)		AS SCHEDULE_DATE
		,CASE WHEN @INTERVAL = 'D' THEN '00:00'
			  WHEN @INTERVAL = 'H' THEN
				CASE WHEN CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)) < 10 THEN 
						CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
					 ELSE
						CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
				END
			  WHEN @INTERVAL = 'T' THEN
				CASE WHEN CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)) < 10 THEN
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (0,15)  THEN
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (30,45) THEN
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':30')
						END
					 ELSE
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (0,15)  THEN
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (30,45) THEN
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':30')
						END
				END
			  ELSE
				CASE WHEN CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)) < 10 THEN
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) = 0 THEN
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 ELSE
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':',CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)))
						END
					 ELSE
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) = 0 THEN
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 ELSE
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':',CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)))
						END
				END
		 END											AS INTERVAL_START
		,SCH.CLIENT_ID									AS CLIENT_ID
		,SCH.CLIENT_NAME								AS CLIENT_NAME
		,SCH.IDPROGR									AS PROGRAM_ID
		,SCH.[PROGRAM_NAME]								AS [PROGRAM_NAME]
		,SUM(SCH.ORIGINAL_SCHEDULED_SECS) / @DS			AS SCHEDULED_TIME_ORIGINAL
		,SUM(SCH.ADDITIONAL_SCHEDULED_SECS) / @DS		AS SCHEDULED_TIME_ADDITIONAL
		,SUM(SCH.CLIENT_REDUCED_SECS) / @DS				AS REDUCED_TIME_CLIENT
		,SUM(SCH.WSOL_REDUCED_SECS) / @DS				AS REDUCED_TIME_WSOL

		--  SELECT *
		FROM
		(
			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0000) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0000) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0015) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0015) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0030) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0030) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0045) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0045) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0100) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0100) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0115) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0115) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0130) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0130) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0145) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0145) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0200) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0200) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0215) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0215) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0230) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0230) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0245) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0245) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0300) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0300) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0315) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0315) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0330) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0330) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0345) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0345) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0400) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0400) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0415) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0415) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0430) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0430) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0445) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0445) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0500) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0500) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0515) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0515) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0530) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0530) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0545) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0545) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0600) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0600) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0615) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0615) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0630) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0630) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0645) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0645) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0700) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0700) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0715) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0715) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0730) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0730) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0745) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0745) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0800) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0800) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0815) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0815) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0830) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0830) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0845) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0845) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0900) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0900) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0915) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0915) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0930) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0930) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F0945) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F0945) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1000) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1000) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1015) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1015) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1030) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1030) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1045) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1045) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1100) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1100) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1115) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1115) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1130) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1130) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1145) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1145) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1200) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1200) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1215) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1215) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1230) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1230) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1245) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1245) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1300) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1300) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1315) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1315) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1330) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1330) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1345) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1345) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1400) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1400) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1415) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1415) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1430) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1430) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1445) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1445) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1500) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1500) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1515) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1515) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1530) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1530) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1545) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1545) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1600) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1600) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1615) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1615) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1630) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1630) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1645) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1645) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1700) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1700) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1715) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1715) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1730) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1730) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1745) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1745) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1800) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1800) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1815) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1815) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1830) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1830) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1845) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1845) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1900) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1900) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1915) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1915) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1930) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1930) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F1945) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F1945) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2000) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2000) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2015) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2015) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2030) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2030) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2045) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2045) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2100) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2100) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2115) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2115) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2130) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2130) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2145) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2145) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2200) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2200) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2215) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2215) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2230) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2230) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2245) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2245) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:00:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2300) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2300) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:15:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2315) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2315) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:30:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2330) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2330) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:45:00' AS DATETIME)	AS INTERVAL_START
			,CASE WHEN S.TYPEOFSCHEDULE = 'Original' THEN
					SUM(S.F2345) * 900
				  ELSE 0 END													AS ORIGINAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFSCHEDULE = 'Additional' THEN
					SUM(S.F2345) * 900
				  ELSE 0 END													AS ADDITIONAL_SCHEDULED_SECS
			,0																	AS CLIENT_REDUCED_SECS
			,0																	AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_SCHEDULE_TYPE_NO_DUPS	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFSCHEDULE

			UNION ALL																				-- <<<<<<<< REDUCTIONS BEGIN HERE

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0000) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0000) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0015) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0015) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0030) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0030) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 00:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0045) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0045) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE
			
			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0100) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0100) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0115) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0115) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0130) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0130) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 01:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0145) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0145) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0200) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0200) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0215) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0215) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0230) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0230) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 02:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0245) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0245) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0300) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0300) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0315) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0315) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0330) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0330) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 03:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0345) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0345) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0400) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0400) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0415) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0415) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0430) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0430) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 04:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0445) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0445) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0500) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0500) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0515) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0515) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0530) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0530) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 05:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0545) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0545) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0600) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0600) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0615) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0615) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0630) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0630) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 06:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0645) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0645) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0700) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0700) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0715) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0715) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0730) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0730) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 07:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0745) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0745) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0800) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0800) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0815) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0815) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0830) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0830) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 08:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0845) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0845) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0900) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0900) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0915) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0915) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0930) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0930) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 09:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F0945) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F0945) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1000) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1000) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1015) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1015) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1030) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1030) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 10:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1045) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1045) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1100) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1100) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1115) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1115) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1130) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1130) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 11:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1145) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1145) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1200) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1200) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1215) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1215) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1230) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1230) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 12:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1245) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1245) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1300) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1300) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1315) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1315) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1330) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1330) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 13:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1345) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1345) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1400) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1400) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1415) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1415) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1430) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1430) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 14:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1445) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1445) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1500) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1500) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1515) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1515) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1530) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1530) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 15:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1545) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1545) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1600) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1600) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1615) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1615) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1630) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1630) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 16:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1645) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1645) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1700) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1700) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1715) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1715) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1730) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1730) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 17:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1745) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1745) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1800) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1800) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1815) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1815) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1830) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1830) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 18:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1845) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1845) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1900) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1900) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1915) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1915) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1930) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1930) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 19:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F1945) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F1945) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2000) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2000) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2015) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2015) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2030) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2030) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 20:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2045) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2045) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2100) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2100) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2115) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2115) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2130) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2130) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 21:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2145) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2145) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2200) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2200) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2215) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2215) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2230) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2230) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 22:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2245) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2245) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:00:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2300) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2300) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:15:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2315) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2315) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:30:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2330) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2330) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE

			UNION ALL

			SELECT
			 S.DATESCH															AS SCHEDULE_DATE
			,S.IDPROGR															AS IDPROGR
			,C.ID																AS CLIENT_ID
			,C.[NAME]															AS CLIENT_NAME
			,P.[NAME]															AS [PROGRAM_NAME]
			,CAST(CONVERT(VARCHAR(10), S.DATESCH) + ' 23:45:00' AS DATETIME)	AS INTERVAL_START
			,0																	AS ORIGINAL_SCHEDULED_SECS
			,0																	AS ADDITIONAL_SCHEDULED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'Client' THEN
					SUM(S.F2345) * 900
				  ELSE 0 END													AS CLIENT_REDUCED_SECS
			,CASE WHEN S.TYPEOFRECUCE = 'WSOL' THEN
					SUM(S.F2345) * 900
				  ELSE 0 END													AS WSOL_REDUCED_SECS
			FROM  SCHTIMES_TL_REDUCE	S
			LEFT JOIN PROGRAM		P ON S.IDPROGR	= P.ID
			LEFT JOIN CLIENT		C ON P.IDCLIENT = C.ID
			WHERE P.ISSHOW = 1
			  AND ( CAST(S.DATESCH AS DATETIME) >= @DTM_BEG AND CAST(S.DATESCH AS DATETIME) < @DTM_END )
			  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(C.ID)	   + ',',@CLIENT_ID) > 0   ) --C.ID = @CLIENT_ID
			  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(S.IDPROGR) + ',',@PROGRAM_ID)> 0   ) -- P.ID = @PROGRAM_ID
			GROUP BY
			 S.DATESCH
			,S.IDPROGR
			,C.ID
			,C.[NAME]
			,P.[NAME]
			,S.TYPEOFRECUCE
		) SCH
	
		WHERE ( CAST(SCH.SCHEDULE_DATE AS DATETIME) >= @DTM_BEG AND CAST(SCH.SCHEDULE_DATE AS DATETIME) <  @DTM_END )
		  AND ( @CLIENT_ID	IN (',0,') OR CHARINDEX(',' + RTRIM(SCH.CLIENT_ID)  + ',',@CLIENT_ID)	> 0 )
		  AND ( @PROGRAM_ID IN (',0,') OR CHARINDEX(',' + RTRIM(SCH.IDPROGR)	+ ',',@PROGRAM_ID)	> 0 )

		GROUP BY
		 CAST(SCH.SCHEDULE_DATE AS DATETIME)
		,CASE WHEN @INTERVAL = 'D' THEN '00:00'
			  WHEN @INTERVAL = 'H' THEN
				CASE WHEN CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)) < 10 THEN 
						CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
					 ELSE
						CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
				END
			  WHEN @INTERVAL = 'T' THEN
				CASE WHEN CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)) < 10 THEN
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (0,15)  THEN
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (30,45) THEN
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':30')
						END
					 ELSE
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (0,15)  THEN
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) IN (30,45) THEN
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':30')
						END
				END
			  ELSE
				CASE WHEN CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)) < 10 THEN
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) = 0 THEN
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 ELSE
								CONCAT('0',CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':',CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)))
						END
					 ELSE
						CASE WHEN CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)) = 0 THEN
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':00')
							 ELSE
								CONCAT(CONVERT(VARCHAR(2),DATEPART(HH,SCH.INTERVAL_START)),':',CONVERT(VARCHAR(2),DATEPART(MI,SCH.INTERVAL_START)))
						END
				END
		 END
		,SCH.CLIENT_ID
		,SCH.CLIENT_NAME
		,SCH.IDPROGR
		,SCH.[PROGRAM_NAME]
	) DAT

	RETURN 
END

GO